# v1.0.0 アップデートのお知らせ

> イェジングラム初の正式リリースです！

今回の v1.0.0 アップデートには、以下の新機能と改善が含まれています。

> 既存のベータ版を利用していた場合は、下部の「アップデート後にマイグレーションエラーが発生する場合の対処」を必ず確認してください。

## 新機能

- トークン数の上限設定
- ComfyUI 対応
- ArtStyle 管理ツール
- 画像の再生成
- 会話の続き生成
- UI テーマのカスタマイズ（ライト／ダーク／カスタム）
- サーバー同期機能
- 多言語対応（韓国語、英語、日本語）
- お知らせの閲覧
- Claude Sonnet 4.5 に対応

## 改善点

- メッセージ編集 UI を改善
- 画像をクリックして拡大表示できる機能を追加
- チャットを開く操作を改善（モバイルはダブルタップ、デスクトップはクリックでチャットウィンドウを開けます）
- AI 設定ページを改善（画面の煩雑さを抑えるため、生成パラメータ設定を「プロンプト設定」の中に移動しました）
- NovelAI 画像生成の強化
  - 画像生成リクエストのパラメータ設定を追加（NAI モデル選択時、画像設定タブで調整可能）
  - 画像用ネガティブプロンプト入力を追加（ArtStyle に設定されたネガティブプロンプトを生成時に反映）
  - キャラクタースタイル認識モードを追加（登録済みキャラクターのプロフィール画像のスタイルを認識して反映）
- エラーページを改善（発生したエラーのスタックを確認できます）
- DB マイグレーション機能を改善（旧バージョンから上位バージョンのページにアクセス、または旧データを読み込む場合に自動でマイグレーション）
- OpenAI 構造化出力に対応
- キャラクター編集画面を改善（編集画面を開いたまま別のキャラクターを編集すると一度に複数ウィンドウが開く問題を解消）
- 長すぎるプレビュー文やグループチャット参加者リストの UI を改善（サイドバーの最近のチャットプレビューと参加者リストが 1 行を超えないように調整）
- AI JSON Fixer を導入（Claude など一部モデルで構造化出力が指定の形式に戻らない場合のフォールバック）

## 削除された機能

- 「先トーク（先にメッセージを送る）」機能に関する設定を一時的に削除しました。技術的な理由により、ユーザーが常にウェブページを開いたままにしない限りトリガーできず、実質的な需要が低いと判断したため、機能の完成を保留します。将来的に再導入する可能性はあります。

## イェジングラムのドメイン移行と開発プレビュー公開

> ドメインを購入しました！
>
> なんと .com を手に入れました！

これに伴い、アドレスを https://yejingram.vercel.app/ から https://yejingram.com/ に移行しました。既存の Vercel アプリのアドレスも引き続き使用できます。

ただし、旧アドレスで使用していたデータは手動でエクスポートし、yejingram.com でインポートする必要があります。

さらに、正式追加前の開発中機能を試してみたい方のために、開発用プレビューサイトを公開します。https://dev.yejingram.com/ にアクセス可能です。

> 注意：開発プレビューサイトは予告なく変更される場合があります。開発中のデータベース構造の変更やエラーによりデータ損失が発生する可能性があり、イェジングラム開発チームはそれらに対して責任を負いません。

- イェジングラム: https://yejingram.com/
- イェジングラム（開発プレビュー）: https://dev.yejingram.com/

---

## 主な追加・改善の詳細

### トークン数の上限

<img width="400" alt="image" src="https://github.com/user-attachments/assets/30523311-f218-4e05-80d7-23135199f9b4" />

入出力の最大トークン数を制限できます。モデルごとに入力トークンを計算し、上限を超える場合はリクエストに含めるメッセージ数を減らします。

### ComfyUI 対応

<img width="400" alt="image" src="https://github.com/user-attachments/assets/2f5e6118-e23f-466e-b218-4f22fef21fb7" />

ComfyUI に対応しました。JSON エディタを使ってワークフローを便利に編集できます。

### ArtStyle 管理ツール

<img width="400" alt="image" src="https://github.com/user-attachments/assets/e20762d8-b070-4f66-8ed5-25ac900d747a" />

画像生成リクエストと一緒に送るポジティブ／ネガティブプロンプトを管理できます。

<img width="400" alt="image" src="https://github.com/user-attachments/assets/97bb0915-2349-4ea7-abed-d3e5fd8d31e5" />

複数の ArtStyle を作成して、使い分けることも可能です。

### 画像の再生成

<img width="400" alt="image" src="https://github.com/user-attachments/assets/d9526461-2d08-42a0-8c79-ebbcebbf5d06" />

生成済みの画像を再生成できます。モバイルでは画像をタップ、デスクトップでは画像にカーソルを重ねると表示される再生成ボタンからリクエスト可能です。

### 会話の続き生成

<img width="200" alt="image" src="https://github.com/user-attachments/assets/f72a9285-84f9-4120-9c52-7a7b87719d62" />

キャラクターの最後の発言をタップ（モバイル）またはカーソルを重ねる（デスクトップ）と表示されるメッセージアクションメニューに「会話の続き生成」を追加しました。

> イェジングラムは 1:1／1:N のチャット型プラットフォームのため、キャラクターの応答のみが続けて生成されます。ユーザーの返信を自動生成して物語を進めることはできません。

### UI テーマのカスタマイズ

ライト、ダーク、システム設定、カスタムテーマから選択できます。
<img width="1000" alt="image" src="https://github.com/user-attachments/assets/7422405b-9c0b-4684-89aa-8e25d17d312d" />

ライトモードのプレビュー

<img width="1000" alt="image" src="https://github.com/user-attachments/assets/165f018e-86b4-4d1e-b67b-53c370595ae1" />

ダークモードのプレビュー

<img width="1000" alt="image" src="https://github.com/user-attachments/assets/2018e969-d40c-4e81-a10e-55f99199107c" />

カスタムテーマを選択すると、カラーパレットエディタが表示され、UI 内のすべての色をカスタマイズできます。

<img width="1000" alt="image" src="https://github.com/user-attachments/assets/bd7b9a10-200b-4ace-9ce3-b32f19ca59b8" />

カスタマイズのプレビュー

### サーバー同期

<img width="400" alt="image" src="https://github.com/user-attachments/assets/697b6bab-e916-4453-9480-4eed5d5f3275" />

軽量な Express ベースの同期サーバーを提供します。ローカルにダウンロードして実行できます。詳細は [ヘルプ](https://github.com/YEJIN-DEV/yejingram/blob/main/README.md#sync-server-optional) をご覧ください。

### 多言語対応

韓国語に加え、英語と日本語に対応します。誤訳が含まれる場合があります。誤訳や翻訳提案については [GitHub の Issue](https://github.com/YEJIN-DEV/yejingram/issues) にてお知らせください。

<img width="1000" alt="image" src="https://github.com/user-attachments/assets/640f00e2-7fd2-4058-b178-ff3b1d4ce0a9" />

韓国語

<img width="1000" alt="image" src="https://github.com/user-attachments/assets/c33d0b74-a07d-4adc-b7c1-65e5fc9c62aa" />

英語

<img width="1000" alt="image" src="https://github.com/user-attachments/assets/fe81ab46-3285-4b09-828f-f98b8e1a1272" />

日本語

### メッセージ編集 UI の改善

<img width="1000" alt="image" src="https://github.com/user-attachments/assets/ebab1a33-08a3-4650-ada7-ed984d99cb74" />

メッセージ編集時に表示される入力欄のサイズを拡大しました。使い勝手が向上します。

### 画像のクリック拡大表示

<img width="400" alt="image" src="https://github.com/user-attachments/assets/f636c213-5d51-4e47-be24-ce0f14e7350d" />

生成済みまたは送信済みの画像をクリックすると、大きく表示できます。

モバイルではダブルタップ、デスクトップではクリックで動作します。

### NovelAI パラメータ調整

<img width="400" alt="image" src="https://github.com/user-attachments/assets/b969e73a-34b3-4a68-958a-a555f04a7e28" />

ベータリリース時に含まれていなかった NovelAI の画像生成パラメータ調整メニューを追加しました。画像設定タブで NAI モデルを選択すると表示されます。

また、スタイル認識モードをオンにすると、現在のキャラクターのプロフィール画像の描画スタイルを認識して反映します。

### お知らせの閲覧

<img width="400" alt="image" src="https://github.com/user-attachments/assets/f73ccd42-0941-4ccc-aed6-cc90efb634b8" />

サイドバー上部の拡声器アイコンから、システムのお知らせを確認できます。

重要なリリースノート、パッチノート、またはシステム障害に関する告知を掲載予定です！

---

## アップデート後にマイグレーションエラーが発生する場合の対処

画像生成プロンプトの保存構造が変更されましたが、マイグレーションを適用することが難しいため、直接プロンプトの初期化を一度実行する必要があります。

<img width="1000" alt="image" src="https://github.com/user-attachments/assets/0761c257-4b28-452f-bb5c-a9bd5fbd97ac" />

プロンプト修正で「初期化」ボタンをクリックすると、プロンプト全体の初期化が可能です。もしプロンプトを修正して使用していた場合は、別途記録しておき、復元する必要があります。

以外の基本的なマイグレーションには対応していますが、設定が混乱する場合があります。以下のようなエラー画面が表示された場合は、
<img width="400" alt="image" src="https://github.com/user-attachments/assets/b448d76f-40ce-4d2a-8f3b-db5dd9ad1bf0" />

API 設定の初期化、プロンプトの初期化、ユーザー情報の初期化、その他設定の初期化は「チャット履歴」には影響せず、保存された API キーやプロンプト、パラメータなどの環境設定のみが初期化されます。

> 注意：「保存済みデータベースの初期化」を行うと、チャット履歴もすべて初期化されます！

上記 4 段階の初期化を行ってもエラー画面が表示される場合は、まず「バックアップ」ボタンでデータをバックアップし、「エラーの詳細」を確認してお知らせください。可能な限り対応します。

## まとめ

前回のベータリリース以降、イェジングラムをより完成度の高い形にするために、約 1 か月の時間を費やしました。必須機能は概ね実装・改善できたと考えています。

正式リリースとなったことで、新機能の追加やバグ修正をより迅速に配布ページへ反映できる見込みです！

イェジングラムをご利用・ご関心いただいている皆さまに、心より感謝申し上げます。

[イェジングラム GitHub](https://github.com/YEJIN-DEV/yejingram) からご貢献いただけます。PR は常に歓迎しています！
