# v2.0.0 アップデートのお知らせ

> Yejingram v2.0.0 のアップデート内容です。

V2 へアップデートされた Yejingram には、多数の新機能が追加されました！ 詳しいアップデート内容は以下をご確認ください。

- **Yejingram**: https://yejingram.com/
- **Yejingram (開発プレビュー)**: https://dev.yejingram.com/
- **Yejingram Realm**: https://realm.yejingram.com/

> 注意事項: 開発プレビューサイトは予告なく変更される可能性があります。開発中のデータベース構造の変更や不具合によりデータ損失が発生する場合があり、これは避けられません。これについて Yejingram 開発チームは責任を負いません。

---

## 新しい機能

- **先トークサーバーの実装**
- **Realm（ベータ）サービス開始**
- バックアップ方式の最適化（パッチ方式）
- ファイルをバイナリで保存するよう変更
- バイナリキャッシングによる最適化
- UI を省いたヘッドレス Yejingram の分離
- 新着お知らせ通知の追加

## 主な追加 / 改善機能の詳細

### 先トークサーバーの実装

<img width="400" alt="image" src="https://github.com/user-attachments/assets/7104770c-ed74-4d6d-bb3c-af83a5fe6c7f" />

ついに完全な先トーク機能が実現しました！ 以前の同期／バックアップサーバーと同様に、先トークサーバーはご自身でダウンロードしてセットアップする必要があります。先トークサーバーは同期サーバーと連携して動作します。

<img width="400" alt="image" src="https://github.com/user-attachments/assets/7909cb6a-6835-400e-afd1-708e2b4c1806" />

このように複数の通知を受け取ることもできますし、

<img width="400" alt="image" src="https://github.com/user-attachments/assets/44d8f275-a753-49a7-b88b-86694c1e9ff7" />

会話の途中で退出すると、しばらくして

<img width="400" alt="image" src="https://github.com/user-attachments/assets/e20fd6bf-d403-4706-a840-0fa8a0127802" />

自然な後続メッセージが届くのを確認できます。

AI の"知能"次第では、以下のように

<img width="400" alt="image" src="https://github.com/user-attachments/assets/939865be-0a90-47eb-93ec-40d8478dac08" />

深夜 4 時にとんでもなくおバカな会話（と画像）が届くこともあるので、タイムゾーン設定はしっかりしておきましょう…

> 注意: 先トークを受け取りたいチャットルームで「先トーク許可」をオンにする必要があります。

<img width="400" alt="image" src="https://github.com/user-attachments/assets/54916e4a-a52b-4fb5-af6d-4e4459bedfa7" />

### Realm（ベータ）サービス

[Yejin Realm はこちら](https://realm.yejingram.com/)

キャラクター共有・制作を活性化するため、Yejingram は Realm サービスを開始します！

<img width="800" alt="image" src="https://github.com/user-attachments/assets/e57c862a-9af1-4165-ae31-398bce181e84" />

Yejin Realm 個別ページ

<img width="800" alt="image" src="https://github.com/user-attachments/assets/f3cbc964-28f3-4d5a-a0f9-b07518cfa2b3" />

Yejingram 内部の Yejin Realm エリア

<img width="800" alt="image" src="https://github.com/user-attachments/assets/d2eee2c7-3a73-4895-a957-c33ab753de01" />

キャラクターページエリア

ボット制作者の皆さまと Yejingram ユーザーの皆さまの、Realm の積極的なご利用をお待ちしております！

（さりげなく登場しましたが、Yejingram 初の公式キャラクター `イ・イェジン` が Realm に登録されていますので、ぜひよろしくお願いします）

- Realm にボットを登録するには会員登録が必要です。個人情報はすべて暗号化して保存されます。詳細は[プライバシーポリシー](https://realm.yejingram.com/privacy)と[利用規約](https://realm.yejingram.com/terms)をご参照ください。

> Realm マイページの概要

<img width="800" alt="image" src="https://github.com/user-attachments/assets/40795414-eaaa-47fc-a461-dfca0352da8c" />

ログイン後にマイページへアクセスすると、上のように自分のキャラクターを管理できます。

<img width="400" alt="image" src="https://github.com/user-attachments/assets/3a44ab86-6695-45a6-a432-87c0f4c30960" />

<img width="400" alt="image" src="https://github.com/user-attachments/assets/78bc8753-5069-4170-82ab-6eed48fe25a3" />

著作権主張未設定、Creative Commons License、WTFPL のいずれかを選択して登録できます。

<img width="800" alt="image" src="https://github.com/user-attachments/assets/2a156e9d-f6e7-46c4-9f7a-8ec2a95882b2" />

登録画面でボットカード情報を最終確認・レビューできます。

<img width="400" alt="image" src="https://github.com/user-attachments/assets/993e088f-6f32-4d6f-9a5d-7be3eddf1907" />

また、多彩なキャラクター紹介文の作成のため、説明文ではマークダウン記法をサポートしています。

### バックアップ方式の最適化

バックアップ／同期サーバーにパッチ方式を導入し、サーバーとクライアントの両方を大幅に最適化しました。

<img width="400" alt="image" src="https://github.com/user-attachments/assets/e44a3096-32c6-4170-bcb9-fa43d15c4a71" />
<img width="400" alt="image" src="https://github.com/user-attachments/assets/4b40f352-f63b-4b93-a096-c5b3a8298a2d" />

従来約 5 秒かかっていた同期処理を

<img width="400" alt="image" src="https://github.com/user-attachments/assets/e7c2ff3e-08b9-43ad-8909-0e4f288bbf7a" />
<img width="400" alt="image" src="https://github.com/user-attachments/assets/41856d9d-b9a8-4e8a-8b69-e6b5b4cf059e" />

パッチ方式の導入により最適化し、0.1 秒未満にまで短縮しました。

### ファイルのバイナリ保存への変更 / バイナリキャッシングの導入

従来 DataURL で保存されていた画像ファイルが、特定の容量（約 100MB）を超えると Chromium 系ブラウザでエラーを引き起こすことを確認しました。

そのためファイルをバイナリで保存するよう変更し、ブラウザにキャッシングすることで約 10 倍高速に画像を読み込めるようにしました。

> 注意: アップデート直後は、以前に送受信した画像が正しく表示されない場合があります。その場合はページを更新すれば解決します。

### UI を省いたヘッドレス Yejingram の分離

先トークサーバーの実装のため、UI のないサーバー向け Yejingram を作成しました。より多彩な方法で Yejingram をご利用いただけることを期待しています！

### 新着お知らせ通知

<img width="400" alt="image" src="https://github.com/user-attachments/assets/622e1d2c-1239-43af-b4c6-5bc7a462db8b" />

お知らせを開くボタンのインジケーター

<img width="400" alt="image" src="https://github.com/user-attachments/assets/70bfad52-9f37-4a4b-9f57-71081c29e89c" />

お知らせ最新投稿のインジケーター

お知らせを見逃すことがないよう、インジケーターを追加しました。

---

## まとめ

前回のアップデートから約 3 か月、個人的な事情で多忙となりアップデートが遅れてしまいました。その分、大きなアップデートをお届けしますので、ぜひたくさんご利用ください！

いつも Yejingram をご利用いただきありがとうございます！

[Yejingram GitHub はこちら](https://github.com/YEJIN-DEV/yejingram) からコントリビュートできます。いつでも PR は歓迎ですので、ぜひご参加ください！
