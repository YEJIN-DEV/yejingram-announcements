# v1.1.0 업데이트 내용

> 예진그램 v1.1.0 업데이트 내용입니다.

이번 v1.1.0 업데이트에서는 다음과 같은 새로운 기능과 개선 사항이 포함되었습니다.

- 예진그램: https://yejingram.com/
- 예진그램 (개발 프리뷰): https://dev.yejingram.com/

> 주의사항: 개발 프리뷰 웹사이트는 언제든지 예고 없이 변경될 수 있으며, 개발 중 데이터베이스 구조 변경 및 오류 발생으로 인한 데이터 손실이 불가피합니다. 이에 대해서 예진그램 개발팀은 책임지지 않습니다.

---

## 새로운 기능

- 메모리 전송 기능 추가
- 수동 선톡 기능 추가
- 단톡에서 응답 계속하기 활성화
- 프로필 이미지 레퍼런스 토글 기능 추가
- 데이터 저장 방식 변경
- OpenRouter 지원
- DeepSeek 지원
- Custom LLM 사용 시 토크나이저/페이로드 형식 설정 지원

## 개선된 기능

- 의도치 않은 메시지 컨트롤 버튼 터치 방지
- 페이지 로딩 최적화 (tiktoken 로드 방식 변경)
- 스티커 관련 오류들 수정 (스티커 표시 resolution 등의 수정)
- END_OF_TURN 오류 방지
- reactionDelay 상한 적용

## 주요 추가/개선 기능 상세 소개

### 메모리 전송 기능

<img width="400" alt="image" src="https://github.com/user-attachments/assets/605c84f8-9d33-4182-93b8-50ea5fd85a10" />

방에 쌓인 메모리를 다른 채팅방으로 옮길 수 있습니다.

<img width="400" alt="image" src="https://github.com/user-attachments/assets/2674a3db-1744-4e85-bfc5-fa9ebca99e98" />

기존 채팅방의 메모리는 제거되지 않으며, 직접 전체삭제를 할 수 있습니다. 전송된 메모리는 다른 채팅방에 순차적으로 등록됩니다. 해당 기능을 이용하여, 개인톡으로 진행하던 메모리를 들고 그룹채팅을 만드는 응용도 가능합니다.

### 수동 선톡 기능

<img width="400" alt="image" src="https://github.com/user-attachments/assets/eb8e9d6d-a080-4d59-a271-b7812e2094ee" />

입력패널 메뉴에 "선톡 요청" 버튼이 추가되었습니다. 캐릭터가 기존 채팅 내역이나 시점을 바탕으로 먼저 연락해줍니다!

캐릭터가 랜덤한 시간에 유저의 요청 없이 선톡을 보내는 것은 기술적인 이유로 구현이 불가능하여, 캐릭터의 선톡을 시뮬레이션할 수 있는 방향으로 개발하였습니다.

> 캐릭터 스타팅 메시지 예시

<img width="400" alt="image" src="https://github.com/user-attachments/assets/dd192a12-b81d-4c2b-ad0d-b98c7ade1ef9" />

> 컨택스트에 기반한 캐릭터 선톡 예시

<img width="400" alt="image" src="https://github.com/user-attachments/assets/60646b76-209e-4673-9315-01c2cd374b8c" />

<img width="400" alt="image" src="https://github.com/user-attachments/assets/d1c06950-6b3b-44f3-81e9-de43d01b8f49" />

### END_OF_TURN 오류 방지

<img width="400" alt="image" src="https://github.com/user-attachments/assets/43dbb5a1-9392-47d2-8b20-0222dfcd7922" />

이어서 응답, 혹은 그룹채팅 이용 시 END_OF_TURN 오류가 발생하는 것을 확인하였습니다.

이번 패치에서는 해당 부분을 수정하였으며, 이제 그룹 채팅에서도 `이어서 응답` 기능을 사용할 수 있습니다!

### 프로필 이미지 레퍼런스 토글

<img width="400" alt="image" src="https://github.com/user-attachments/assets/59551770-2c03-40a6-b89c-cc427cd53e51" />

기존에는 이미지 생성 요청 시 프로필 이미지를 강제로 레퍼런스에 포함시키고 있었습니다. 해당 기능을 토글 가능하도록 버튼을 추가하였습니다. 이미지에 호버링(모바일의 경우 탭)할 경우 표시되는 액션 모음에 파란색으로 토글이 켜져있으면 레퍼런스 사용, 꺼져있으면 미사용입니다. 기본값은 사용으로 고정되어 있습니다.

### 데이터 저장 방식 변경

<img width="400" alt="image" src="https://github.com/user-attachments/assets/4ebd948d-9d9f-41e6-8d94-6335bdeaf2c7" />


Chromium 계열 브라우저(Chrome, Samsung Internet, Edge 등)에서 세이브 용량이 100MB를 넘어가면 앱이 죽는 현상을 확인했습니다. 이 점을 개선하기 위해 데이터 저장 방식을 일부 변경하였습니다. 기존 세이브 데이터는 그대로 사용 가능합니다.

### OpenRouter / DeepSeek 지원

<img width="400" alt="image" src="https://github.com/user-attachments/assets/1b99eb41-2448-4159-ae16-a556988baf67" />

<img width="400" alt="image" src="https://github.com/user-attachments/assets/cc91d2c0-173e-4013-8e99-2dd808d57ea4" />

이제 AI 설정에서 OpenRouter와 DeepSeek을 사용할 수 있습니다!

### Custom LLM 관련 설정 확대

<img width="400" alt="image" src="https://github.com/user-attachments/assets/406de045-9c9b-4902-a0c7-3a4818a9eb01" />

Custom LLM을 사용하는 경우, 자유롭게 설정할 수 있도록 토크나이저와 페이로드 형식 선택창을 추가하였습니다. 선택 가능한 옵션은 아래와 같습니다.

- 토크나이저: OpenAI (o200k_base, cl100k_base), DeepSeek, Llama2, Llama3, Llama4, Mistral, Qwen, Qwen3
- Payload: OpenAI, Anthropic, Gemini

### reactionDelay 상한 적용

구조화된 출력 사용 시 캐릭터로부터 받은 응답을 띄우는 대기시간인 reactionDelay가 LLM이 너무 똑똑한 나머지 쓸데없이 현실적인 숫자를 줘버리는 경우를 확인하였습니다.

<img width="400" alt="image" src="https://github.com/user-attachments/assets/f10856a5-b440-4f31-8f1c-76e87aff2aee" />

회의 하고 온다는 캐릭터를 3시간씩 기다려야하는 불상사가 생기지 않도록, reactionDelay의 상한선을 10초로 설정하였습니다.

---

## 마무리

예진그램을 항상 사용해주시는 여러분께 감사드립니다! 앞으로도 예진그램을 재밌게 즐기실 수 있도록 유용한 기능과 쾌적한 사용환경을 위해 노력하겠습니다!

[예진그램 GitHub 바로가기](https://github.com/YEJIN-DEV/yejingram)를 통해서 기여하실 수 있습니다. 언제나 PR은 열려있으므로, 많은 기여 부탁드립니다!
